# 计算机网络（计算机网络(第八版)& 大话通信）
# 1. 计算机基础结构知识
（来源：https://www.nowcoder.com/test/question/done?tid=46951991&qid=104556#summary）

> 计算机网络是用通信线路将分布在不同地点并具有独立功能的多台计算机系统互相连接，
按照网络协议进行数据通信实现资源共享的信息系统。

## 1.1 计算机网络的类型：
1. 按照网络交换方式的不同进行分类
   1. 电路交换网络
   2. 报文交换网络
   3. 分组交换网络
   4. 混合交换网络（同时采用电路交换和分组交换）
2. 按照网络通信媒体的不同进行分类
   1. 有线网络
   2. 无线网络
   3. 混合网络（同时采用有线和无线）
3. 按照网络使用范围的不同进行分类
   1. 公用网路，如Internet。它是为公众提供各种信息服务的网络系统，只要用户能够遵守网络服务商的使用和管理规则都可以申请使用。
   2. 专用网络，如校园网。它是由特定组织或者部门自己投资建立的网络系统，只有网络拥有者才可以使用。
   3. 接入网，它是一种比较特殊的计算机网络，通常是指骨干网络到用户终端之间的所有设备，起到一个桥梁的作用。
4. 按照网络连接范围的不同进行分类
   1. 局域网络（LAN），覆盖范围是几百米到几千米
   2. 城域网络（MAN），大型的局域网
   3. 广域网络（WAN），多个局域网互联后的覆盖范围更广的网络
   4. 个人区域网络（PAN），将个人使用的设备用无线技术连接起来的网络，覆盖范围是10米左右。
   
> 现代互联网结构：在internet中，用户计算机需要通过校园网，企业网或者ISP连入地区主干网；地区主干网通过国家主干网联入国家间的高速主干网，这样就形成了一种由路由器连接的大型、具有层次结构的互联网络。   

## 1.2 计算机网络的组成：
![pic1](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565170777990_DDE2EF8C5748CF8405A457B8BA0E8DA9.png)
1. **通信子网**
> ***通信子网是资源子网中各主机之间相互通信的基本环境，为资源子网提供传递信息服务。***
***它的基本组成如下：***
   1. **集线器、中继器**：
      用于同一网段上不同计算机之间的连接。工作在物理层。
      功能：将经过一定距离传输后衰减和失真的电信号放大整形后再发送到网段上去，以实现更
      长距离的传输。只能连接同一类型的局域网。
   1. **网桥、第二层交换机**：
      用于不同网段上计算机之间的连接。工作在数据链路层。
      功能：在单个网路中进行存储转发。可连接不同类型的局域网。
   2. **路由器、第三层交换机：** 
      用于各网络上计算机之间的连接。工作在网络层。
      功能：在多个网络中存储转发。路由选择。

2. **资源子网**
***资源子网实现全网的面向应用的数据处理和网络资源共享。
   它的基本组成如下：***
   1. 客户机：使用网络资源（各类终端，打印机）
   2. 服务器：提供网络资源
1. **协议**
***协议是主机和主机之间，主机和通信子网之间，通信子网中各结点之间通信时必须遵守的规则。***

## 1.3 计算机网络的拓扑结构：
> **在计算机网络中，计算机（主机（客户机，服务器），交换机，路由器，集线器等）作为结点，连接计算机的通信线路作为链路。
网络中实体间的结构关系称之为网络的拓扑结构。
网络的拓扑结构对网络性能、系统可靠性与通信费用都有重大影响。
按照网络中一条链路能够连接计算机台数的不同，计算机网络的拓扑结构可分为：**

1. 链路型网络。每条物理线路连接一对结点。（点对点结构）可细分为：
   1. 星型网络。
   ![pic2](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565173989870_977E7C968469A80CE46B9EADD038C45C.png)
     特点：结点与多条链路连接，外围结点只与一条链路连接。
优点：数据传输不会在线路上发生碰撞，网络系统比较容易扩充。
缺点：结点实施对全网的控制，容易成为网络系统的“瓶颈”。
   1. 树形网络。
![pic3](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565175012520_95BA7B1690DFEBB37818860793CBFCA5.png)
        特点：多个星型结够的级联组合。有多个结点，每个结点与多条链路相连，其余结点只与一条链路相连。
优点：管理方便。
缺点：共享能力差。
   1. 环形网络。
![pic4](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565174289925_94321CCBB80686CD1D8D44CC72F9EFB6.png)
        特点：把所有结点连接成环形。每个结点都与两条链路连接。
优点：但某一链路发生故障时，可以通过另一条链路进行通信。
   1. 网状型网络。
![pic5](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565175268019_EF96B6BBC0C5E9D5169AD73C3BCE9648.png)
        特点：所有结点都与两个或两个以上的链路相连。
        优点：可靠性高。
        缺点：结构复杂，费用高。
2. 广播型网络。每条物理线路可以连接多个结点。**（多点共享结构）**
![pic6](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565175549768_F4480C908205DF45D49DB87563EF3CCD.png)
    特点：每个链路为多个结点共享。
    优点：一个结点发送的信心可以传输到其他所有在同一条链路上的结点。
    缺点：当有多个结点同时发送信息时，便会引起冲突。
## 1.4 计算机网络的功能：
1. **数据通信。数据通信功能是计算机网络的基本功能，也是实现其他功能的基础。它具体包括以下几点内容：**
   1. 连接的建立和拆除。为使源主机和目标主机进行通信，我们必须首先在它们之间建立一条逻辑链路，待通信结束后拆除。
   2. 数据传输控制。为使数据能在网络中正确的传输，我们必须为数据加上报头，实际的用户数据就成为了报文体。报头中主要包括控制数据
传输的信息，如源地址，目标地址，报文序号等信息。网络根据报头内容可控制报文的传输。
   3. 差错控制。数据在网络中传输难免会出现差错，为减少错误的发生，我们必须采用差错控制措施，其既可以检错，又可以纠错。
   2. 流量控制。源主机发送数据的速度应与目标主机接受数据的速度相匹配，以免发生网络拥塞。
   3. 路由控制。源主机和目标主机之间有多条链路可以进行通信，路由器根据传输路径最短、传输时延最小，传输费用最低等标准选择一条最
佳的传输链路。
   1. 多路复用。为提高传输链路的利用率，将一条物理链路虚拟为多条虚电路，使一条物理链路能被多个“用户对”同时所用。
1. **资源共享。资源共享是计算机网络的主要目标。资源共享包括数据共享、软件共享、硬件共享。**
2. **负荷均衡和分布处理。**
   1. 负荷均衡指将网络中的工作负荷均匀的分配给网络中的其他计算机系统。
   2. 分布处理指将一个完整的任务分成若干个步骤，每个步骤由网络中的一个计算机系统来处理。

## 1.5 计算机网络的性能：
1. 带宽。
数字信道所能传送的最高数据率。单位是b/s。
更常用的带宽单位：
   1. kb/s（10^3b/s）
   2. Mb/s（10^6b/s）
   3. Gb/s（10^9b/s）
   4. Tb/s（10^12b/s）
   
   频宽：单位bps，表示每秒可传输的位数。
1. 吞吐量。
在单位时间内通过信道的数据量。吞吐量<=带宽
3. 时延。
![shiyan](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565179290183_CAD84065C122A488E1563B01DD12BE8B%20(1).png)

   1. 排队时延。数据在队列中排队等待处理所经历的时间。
   2. 处理时延。数据在发送之前进行一些必要处理所花费的时间。
   3. 传输时延。数据从结点进入到传输媒体中所花费的时间。数据长度/信道带宽
   4. 传播时延。数据在传输媒体中经历的时间。链路长度/传播速度。
   - **注意：传输时延和传播时延是两个不同的概念，提高链路带宽只是减小了数据的传输时延。**
   - **总时延 = 排队时延+处理时延+传输时延+传播时延**
4. 时延带宽积。
![shiyandkj](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565179966179_6F32657A67C5C971C838D5BCD695B50B%20(1).png)
   链路中容纳的比特数：时延带宽积 = 带宽 x 传播时延
5. 往返时延。（RRT）
   从发送端发送数据开始到发送端收到接收端的确认为止所经历的时间。

### 1.6 数据交换技术：
1. 电路交换（线路交换）
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565180650614_2ACE7E0DDC324F941D9408346EC00132.jpeg)
通信的计算机之间必须事先建立物理线路。整个电路交换过程包括：建立线路，传输数据，释放线路三个阶段，因此是面向连接的。
   - 优点：建立连接后传输时延小，不会发生数据传输冲突。
   - 缺点：建立物理线路耗时长，独占线路，线路利用率低，无纠错机制。
   - 注意：电路交换技术是一种较早的交换技术，现在计算机网络通信基本不采用电路交换，而采用存储转发技术。

1. 存储转发技术
>**原理：**
>>网络中的每一个结点都有一个缓冲区，当要进行转发时，就将要传递的数据存放在该结点的缓冲区中，待线路空闲的时候由交换机或路由器将数据信息传输到下一跳的缓冲区中去。（数据从源主机到目标主机一般要进行多级转发，即通过多个交换机或路由器进行传递。每经过一个交换机和路由器就称为**一“跳”**。）

> **结点交换机的工作流程：**
>> - 先将收到的数据信息存放在缓冲区
>> - 查找转发表，找出到某个目的地址应该从哪个端口转发
>> - 将数据信息从该端口转发出去。

> **分类：**
> 1. 报文交换
要传输的数据必须整体一次性进行存储转发。
报文交换的时延较长。现在很少有人使用了。
> 2. 分组交换
发送端要发送的一条完整的数据信息叫做报文。
将较长的报文划分成较短的，固定长度的数据段就形成了报文段。
将每个报文段添上首部（含地址等信息）就构成了分组。
源主机和目的主机在通信之前现在网络中建立一条逻辑线路，在通信过程中数据信息就按照该逻辑线路进行传输，这种方式称为虚电路方式。
虚电路指的是一条逻辑线路而不是一条物理线路，一条物理线路可以被多条虚电路使用。

> **分组交换的过程：**
a、在发送端将较长的报文划分成较短的，固定长度的数据段。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565190721276_CB7D08351F55845FA205675CB00B2ED2.png)
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565233114974_2ACE7E0DDC324F941D9408346EC00132.jpeg)
b、在每个数据段之前加上首部构成分组。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565233173097_3C673479277F4336707DC93A70A6D81C.png)
c、依次将每个分组发送给接受端。
d、接收端收到分组后剥去首部并还原成报文。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565233301988_AECD42CA7D4731D7AD76DC61E9518418.png)

> **优点：**
>> 一条物理线路可以被多条逻辑线路使用，因此线路利用率高；
>> 分组在网络中被多次存储转发，因此不同种类的终端可以相互通信；
>> 网络具有差错控制，重发机制以及路由机制，因此信息传输可靠性高；
>> 分组具有地址等控制信息，因此可以把同一信息发送给不同用户；
>
> **缺点：**
>> 分组在各结点存储转发时需要排队，会造成一定的时延。
>> 分组必须携带首部，会造成一定的开销。

## 1.7网络体系结构及协议：
1. **为什么会有体系结构：**
相互通信的两个计算机之间必须高度协调工作才行，而这种“协调”是非常复杂的。“分层体系结构”采用分而治之的思想将复杂的问题分成若干个
较小的局部问题，而这些较小的局部问题就比较易于研究和处理。具体地，是将总体要实现的功能分配在不同层次中，对每个层次要完成的服务都有明确规定；每层可以使用下层提供的服务，并向上层提供服务；高层使用低层提供的服务时，并不需要知道低层服务的具体实现，各层之间相互独立。
2. **为什么会有协议：**
网络中的两台计算机要想进行数据通信，实现资源共享就必须遵循事先定义好的规则。
因此，网络体系结构就是各层极其协议的集合。

## 1.8计算机网络的层次模型：
不同主机之间的相同层次称为对等层。
对等层之间互相通信需要遵守一定的规则。
对等层上传输的数据单位统称为协议数据单元（PDU）。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565235386143_E1CA1E8EF51A00FFF66D027A8A483012.png)

**早期的有OSI模型和TCP/IP模型，后期综合考虑两个模型之间的优缺点，制定了一个五层协议的体系结构，分别是**
   1. 应用层：规定应用进程在通信时所遵循的协议，如HTTP、SMTP、FTP、DNS等。PDU是报文。
   2. 传输层：负责主机中两个进程之间的的通信。PDU是报文段。
   3. 网络层：负责网络中两个主机之间的通信。PDU是分组。
   4. 数据链路层：负责网络中两个相邻结点之间的通信。PDU是帧。
   5. 物理层：透明的传输比特流。PDU是比特。
   
备注：
OSI参考模型：
   应用层-表示层-会话层-传输层-网络层-数据链路层-物理层
TCP/IP模型：
   应用层-传输层-互联层-网际层

计算机网络的工作过程：计算机1向计算机2发送数据
通过物理媒介，从发送端物理层传送到接受端物理层。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/551437339_1565237248585_CED0E0B9005493AF9915C290E549DDCD.png)

## 1.8 IP数据报的结构：
TCP/IP协议定义了一个在因特网上传输的包,称为IP数据报。
IP数据报由首部和数据两部分组成。首部的前一部分是固定长度,共 20 字节，是所有IP数据报必须具有的。在首部的固定部分的后面是一些可选字段，其长度是可变的。
下图中的首部长度部分占 4 位，可表示的最大十进制数值是15。注意：这个字段所表示的数的单位是32位字 (1个32位字长是4个字节)。
因此,当 IP 的首部长度的4位为 1111 时 (即十进制的 15)，首部长度就达到 15*4=60字节。因此本题选C。
首部长度限制为 60字节的缺点是有时可能不够用，这样做的目的是希望用户尽量减少开销。
最常用的首部长度就是 20 字节 (即首部长度的4位为 0101)，这时不使用任何选项。
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/4521295_1580980217017_4A47A0DB6E60853DEDFCFDF08A5CA249.png)

# End:附录

---
#### ARP
1. 关于ARP概念
   - ARP完成了ip地址到mac地址的映射。是因为在实际网络的链路上传送数据帧时，最终必须使用硬件地址。
   - 其工作原理是：当主机a向主机b发送数据报时，要先在其arp高速缓存中查看有无主机b的ip地址。找到后，查出其对应的mac地址，并写入mac帧，通过局域网将此mac帧发往此mac地址。
   - 由于arp“看到了”ip地址，所以它工作在网络层。
2. 那些可能你们不明白的操作
   - ip地址是在网络层使用的地址，硬件地址是在数据链路层使用的地址。mac帧是由ip数据报分组封装成的，所以数据链路层看不见数据报分组中的ip地址。每次路由转发，ip分组在每个网络中都被路由器解封装和重新封装。这也是为什么不能使用mac地址跨网络通信。（每次重新封装后的mac地址都在不断的变化。）
   - 对网络层而言，数据链路层的基本任务是将源机器中来自网络层的数据传输到目标机器的网络层。
   - 在网络层由于路由器的隔离，ip网络无法通过广播方式依靠mac地址来完成跨网络的寻址，因此只使用ip地址来完成寻址。
   - 在ip分组通过路由转发找到目标网络后，改为在目标网络LAN中通过数据链路层的mac地址以广播方式寻址。从而提高了路由选择效率。
   - ![ARP](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/v2-dda7233df8024c1c2fc75e52b6b711de_r.jpeg)     
---

![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/%E6%88%AA%E5%B1%8F2021-08-25%2011.06.32.png)
![](https://tuchuang-jiachzha.oss-cn-hangzhou.aliyuncs.com/img/%E6%88%AA%E5%B1%8F2021-08-25%2010.30.19.png)

**DNS在同时占用用TCP和UDP的53端口 在数据传送时使用可靠的TCP协议 在域名解析时使用UDP协议**
> IEEE 802.1 ：局域网体系结构、寻址、网络互联和网络。
IEEE 802.1A：概述和系统结构。
IEEE 802.1B：网络管理和网络互连。
IEEE 802.2 ：逻辑链路控制子层（LLC）的定义。
IEEE 802.3 ：以太网介质访问控制协议 （CSMA/CD）及物理层技术规范。
IEEE 802.4 ：令牌总线网（Token-Bus）的介质访问控制协议及物理层技术规范。
IEEE 802.5 ：令牌环网（Token-Ring)的介质访问控制协议及物理层技术规范。
IEEE 802.6 ：城域网介质访问控制协议DQDB （Distributed Queue Dual Bus 分布式队列双总线）及物理层技术规范。
IEEE 802.7 ：宽带技术咨询组，提供有关宽带联网的技术咨询。
IEEE 802.8 ：光纤技术咨询组，提供有关光纤联网的技术咨询。
IEEE 802.9 ：综合声音数据的局域网（IVD LAN）介质访问控制协议及物理层技术规范。
IEEE 802.10：网络安全技术咨询组，定义了网络互操作的认证和加密方法。
IEEE 802.11：无线局域网（WLAN）的介质访问控制协议及物理层技术规范。

有两种类型的网络链路：**点对点链路**和**广播链路**。 
点对点链路：有链路一端的单个发送方和链路另一端的单个接收方组成。 
广播链路：能够有多个发送和接收节点连接到相同的、单一的、共享的广播信道。广播是指当任何一个节点传输一帧时，该信道广播该帧，从而让其他节点都可以收到一个拷贝。这时就会出现多址访问问题，即协调多个发送和接收节点对一个共享广播信道的访问的问题。这就是多址访问协议存在的原因。 
多址访问协议分类： 
1. 信道划分协议 
   1. 时分多路复用（TDM）：把时间划分为若干个时间帧，把每个时隙分配给N个节点中的一个。
   2. 频分多路复用（FDM）：把信道划分为多个频段，每个节点使用一个频段
   3. 码多分址（CDMA）：为每一个节点分配不同的编码，然后每个节点用它唯一的编码对发送的数据进行编码。这样即使多个节点的信息杂糅在一起也能够让各自的接收方正确接收信息。
2. 随机访问协议 
随机访问协议是一个传输节点占用信道全部速率进行发送，当有碰撞时，等待一个随机时延然后重复发送。 
   1. 载波侦听多址访问（CSMA）：先听后发，边发边听，冲突停发，随机延迟后重发 
   其中带碰撞检测的CSMA（CSMA/CD）用于有线局域网如以太网中， 
   而带碰撞避免的CSMA （CSMA/CA）用于无线局域网如802.11中。
   1. 分段（或时隙）ALOHA：边发边听，冲突停发，随机延迟后重发 
我们假定所有帧为L比特，时间被划分为时隙（一个时隙传输一帧）。约定每个结点只在时隙起点开始传输帧，且每个结点都知道时隙何时开始。一旦发生碰撞，就等待一段随机长的时间后重发该帧。
3. 轮流协议 
   1. 轮询协议：在参加会议的人中选择一个主持人（主节点），由主持人来告诉每一个参加会议的人“你可以讲话了，但是你讲话的量不能超过多少分钟（字节）”
   2. 令牌（Token）传递协议： 
令牌环网是一种定义在 IEEE 802.5 中，其中所有的工作站都连接到一个环上，每个工作站只能同直接邻的工作站传输数据的网络。令牌环上传输的小的数据（3个字节的一种特殊帧）叫为令牌，谁有令牌谁就有传输权限。如果环上的某个工作站收到令牌并且有信息发送，它就改变令牌中的一位（该操作将令牌变成一个帧开始序列），添加想传输的信息，然后将整个信息发往环中的下一工作站。当这个信息帧在环上传输时，网络中没有令牌，这就意味着其它工作站想传输数据就必须等待。因此令牌环网络中不会发生传输冲突。 
与以太网 CSMA/CD 网络不同，令牌传递网络具有确定性，这意味着任意终端站能够传输之前可以计算出最大等待时间。